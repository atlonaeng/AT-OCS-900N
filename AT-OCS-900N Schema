{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://atlona.com/schema/AT-OCS-900N_API_Schema.json",
    "type": "object",
    "title": "Atlona AT-OCS-900N JSON API",
    "description": "The AT-OCS-900N JSON API schema.",
    "$defs": {
        "export_config_reply": {
            "type": "object",
            "properties": {
                "configuration": {
                    "type": "object",
                    "description": "The requested configuration"
                },
                "name": {
                    "type": "string",
                    "description": "The name of the configuration."
                }
            }
        },
        "list_config_reply": {
            "type": "object",
            "properties": {
                "configurations": {
                    "type": "array",
                    "description": "A list of available configurations",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "introspect_reply": {
            "type": "array",
            "description": "A list of set, get or methods available on this system",
            "items": {
                "type": "string"
            }
        }
    },
    "oneOf": [
        {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "User supplied value, identifying the request"
                }
            },
            "oneOf": [
                {
                    "properties": {
                        "get": {
                            "type": "string",
                            "description": "The name of the configuration node to retrieve",
                            "enum": [
                                "info",
                                "sensors",
                                "led",
                                "protocols",
                                "network",
                                "user"
                            ]
                        }
                    }
                },
                {
                    "properties": {
                        "set": {
                            "type": "object",
                            "description": "Apply a new partial configuration",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "description": "The name of the configuration node to update",
                                    "enum": [
                                        "info",
                                        "sensors",
                                        "led",
                                        "protocols",
                                        "network",
                                        "user"
                                    ]
                                },
                                "config": {
                                    "anyOf": [
                                        {
                                            "info": {
                                                "$ref": "AT-OCS-900N_API_Schema.json#/$defs/info"
                                            },
                                            "sensors": {
                                                "$ref": "AT-OCS-900N_API_Schema.json#/$defs/sensors"
                                            },
                                            "led": {
                                                "$ref": "AT-OCS-900N_API_Schema.json#/$defs/led"
                                            },
                                            "protocols": {
                                                "$ref": "AT-OCS-900N_API_Schema.json#/$defs/protocols"
                                            },
                                            "network": {
                                                "$ref": "AT-OCS-900N_API_Schema.json#/$defs/network"
                                            },
                                            "user": {
                                                "$ref": "AT-OCS-900N_API_Schema.json#/$defs/user"
                                            }
                                        }
                                    ]
                                }
                            },
                            "required": [
                                "name",
                                "config"
                            ]
                        }
                    }
                },
                {
                    "properties": {
                        "method": {
                            "type": "object",
                            "description": "Generic method invocation",
                            "properties": {
                                "reboot": {
                                    "type": "object",
                                    "description": "Reboot the device",
                                    "properties": {}
                                },
                                "introspect": {
                                    "type": "object",
                                    "description": "Enumerate the available set/get nodes or method calls",
                                    "properties": {
                                        "type": {
                                            "type": "string",
                                            "enum": [
                                                "get",
                                                "set",
                                                "method"
                                            ]
                                        }
                                    }
                                },
                                "factory_default": {
                                    "type": "object",
                                    "description": "Reset the device to factory defaults and reboot",
                                    "properties": {}
                                },
                                "export_config": {
                                    "type": "object",
                                    "description": "Export the configuration",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "description": "The name of the requested configuration. \"current\" is the currently active configuration."
                                        }
                                    }
                                },
                                "import_config": {
                                    "type": "object",
                                    "description": "Import a new configuration",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "description": "The name of the new configuration. \"current\" is the currently active configuration."
                                        },
                                        "configuration": {
                                            "type": "object",
                                            "description": "The configuration to store, as a JSON object"
                                        }
                                    }
                                },
                                "import_config_file": {
                                    "type": "object",
                                    "description": "Import a new configuration from an uploaded file",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "description": "The name of the requested configuration. \"current\" is the currently active configuration."
                                        },
                                        "file": {
                                            "type": "string",
                                            "description": "The name of the file returned by the webserver after it was POSTed to /upload/"
                                        }
                                    }
                                },
                                "list_config": {
                                    "type": "object",
                                    "description": "List the available configurations",
                                    "properties": {}
                                },
                                "identify": {
                                    "type": "object",
                                    "description": "Enable/disable blinking of LED indicator.",
                                    "properties": {}
                                },
                                "upgrade": {
                                    "type": "object",
                                    "properties": {
                                        "file": {
                                            "type": "string",
                                            "description": "The name of the file returned by the webserver after it was POSTed to /upload/"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            ]

        },
        {
            "type": "object",
            "description": "A response to a get/set request",
            "properties": {
                "error": {
                    "type": "boolean",
                    "description": "Present in all replies, true if there was a problem with the request."
                },
                "error_message": {
                    "type": "string",
                    "description": "Description of the problem with the request. Present if \"error\" is true"
                },
                "id": {
                    "type": "string",
                    "description": "Identification of the request, returns the value supplied by the called"
                },
                "config": {
                    "anyOf": [
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/info"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/deviceInfo"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/systemInfo"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/hardwareInfo"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/networkInfo"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/protocolInfo"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/sensors"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/motionSensor"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/lightSensor"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/tempSensor"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/led"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/user"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/network"
                        },
                        {
                            "$ref": "AT-OCS-900N_Configuration_Schema.json#/$defs/protocols"
                        }
                    ]
                },
                "reply": {
                    "anyOf": [
                        {
                            "$ref": "#/$defs/export_config_reply"
                        },
                        {
                            "$ref": "#/$defs/list_config_reply"
                        },
                        {
                            "$ref": "#/$defs/introspect_reply"
                        }
                    ]
                }
            },
            "required": [
                "error"
            ]
        }
    ]
}
